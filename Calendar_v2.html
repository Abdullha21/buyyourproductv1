<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar Save Money Account</title>
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Hind Siliguri',sans-serif; }
        body { background:linear-gradient(135deg,#0a0f1a,#121a2e); color:#e0e0e0; min-height:100vh; padding:15px; line-height:1.6; }
        .container { max-width:1000px; margin:0 auto; }
        .card { background:rgba(26,30,46,0.92); padding:25px; border-radius:16px; box-shadow:0 10px 40px rgba(0,255,136,0.12); margin-bottom:20px; border:1px solid rgba(0,255,136,0.18); backdrop-filter:blur(6px); }
        h1,h2,h3 { color:#00ff88; text-align:center; margin-bottom:20px; text-shadow:0 0 10px rgba(0,255,136,0.4); }
        input,textarea,select,button { width:100%; padding:12px; margin:8px 0; border:none; border-radius:10px; background:#1e2535; color:white; font-size:16px; transition:all 0.3s ease; }
        input:focus,textarea:focus,select:focus { outline:2px solid #00ff88; background:#252f44; box-shadow:0 0 15px rgba(0,255,136,0.3); }
        button { background:linear-gradient(90deg,#00ff88,#00cc70); color:black; font-weight:bold; cursor:pointer; transition:all 0.3s; }
        button:hover { transform:translateY(-3px); box-shadow:0 8px 20px rgba(0,255,136,0.4); }
        .logout-btn { background:linear-gradient(90deg,#ff4444,#cc0000); color:white; border:none; padding:12px 24px; border-radius:10px; cursor:pointer; font-weight:bold; transition:all 0.3s; }
        .logout-btn:hover { transform:translateY(-3px); box-shadow:0 8px 20px rgba(255,68,68,0.4); }
        .hidden { display:none !important; }
        
        /* ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßá‡¶ú ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        .auth-container { max-width:500px; margin:50px auto; }
        .login-logo { text-align:center; margin-bottom:30px; }
        .login-logo img { height:80px; width:auto; margin-bottom:15px; }
        .login-logo h1 { color:#00ff88; font-size:1.8em; margin-top:10px; }
        .auth-tabs { display:flex; margin-bottom:20px; border-bottom:2px solid #1e2535; }
        .auth-tab { flex:1; padding:15px; text-align:center; cursor:pointer; background:none; border:none; color:#aaa; font-size:18px; font-weight:bold; transition:all 0.3s; }
        .auth-tab.active { color:#00ff88; border-bottom:3px solid #00ff88; }
        .auth-form { display:none; }
        .auth-form.active { display:block; }
        .button-group { display:flex; gap:15px; margin-top:20px; }
        .button-group button { flex:1; }
        
        /* ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ */
        .loader-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            display: none;
        }
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(0, 255, 136, 0.3);
            border-radius: 50%;
            border-top-color: #00ff88;
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .loading-text {
            color: #00ff88;
            margin-top: 20px;
            font-size: 18px;
            text-align: center;
        }
        .small-loader {
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 255, 136, 0.3);
            border-radius: 50%;
            border-top-color: #00ff88;
            animation: spin 1s ease-in-out infinite;
            display: inline-block;
            margin-right: 10px;
        }
        .progress-container {
            width: 100%;
            height: 4px;
            background: #1e2535;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 10000;
            display: none;
        }
        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff88, #00cc70);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶°‡¶≠‡¶æ‡¶®‡ßç‡¶∏‡¶° ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞ */
        .advanced-features { margin-top:30px; padding:20px; background:rgba(30,37,53,0.5); border-radius:12px; border-left:4px solid #00ff88; }
        .feature-list { display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:15px; margin-top:15px; }
        .feature-item { background:rgba(26,30,46,0.7); padding:15px; border-radius:10px; border:1px solid rgba(0,255,136,0.1); transition:all 0.3s; }
        .feature-item:hover { border-color:#00ff88; transform:translateY(-3px); }
        .feature-icon { font-size:24px; margin-bottom:10px; }
        
        /* ‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ */
        #calendar { display:grid; grid-template-columns:repeat(7,1fr); gap:8px; margin:20px 0; }
        .calendar-header { background:#1e2535; padding:12px; border-radius:10px; text-align:center; font-weight:bold; color:#00ff88; font-size:14px; }
        .day { background:#1e2535; padding:6px 4px; border-radius:12px; text-align:center; cursor:pointer; min-height:70px; transition:all 0.4s ease; position:relative; overflow:hidden; border:2px solid transparent; }
        .day:hover { transform:scale(1.04); border-color:#00ff88; box-shadow:0 0 20px rgba(0,255,136,0.3); }
        .day.today { border:2px solid #00ff88; background:#142022; transform:scale(1.03); }
        .day.has-data { background:linear-gradient(135deg,#003320,#002211); transform:scale(1.06); box-shadow:0 0 25px rgba(0,255,136,0.5); animation:pulseGlow 2.5s infinite; }
        @keyframes pulseGlow { 0%{box-shadow:0 0 12px rgba(0,255,136,0.4);} 50%{box-shadow:0 0 30px rgba(0,255,136,0.8);} 100%{box-shadow:0 0 12px rgba(0,255,136,0.4);} }
        .day-number { font-size:16px; font-weight:bold; margin-bottom:2px; color:#ffffff; }
        .day-amount { font-size:11px; margin:1px 0; padding:1px 4px; border-radius:4px; background:rgba(0,0,0,0.4); }
        .day-source { font-size:9px; color:#bbb; margin-top:2px; word-break:break-word; display:none; }
        .month-nav { display:flex; justify-content:space-between; align-items:center; margin:20px 0; }
        .month-nav button { width:50px; padding:10px; background:#1e2535; color:#00ff88; font-size:20px; border-radius:10px; }
        .month-nav button:hover { background:#2a344a; }
        .summary p { font-size:1.2em; margin:10px 0; padding:10px; background:#1e2535; border-radius:10px; }
        .profit { font-size:1.6em !important; font-weight:bold; color:#00ff88 !important; background:#142022 !important; padding:15px !important; border-radius:12px; box-shadow:0 0 15px rgba(0,255,136,0.3); }
        .loss { color:#ff4444 !important; background:#2a1a1a !important; }
        .modal { display:none; position:fixed; z-index:1000; left:0; top:0; width:100%; height:100%; background:rgba(0,0,0,0.92); overflow:auto; }
        .modal-content { background:#1a1e2e; margin:5% auto; padding:30px; width:90%; max-width:520px; border-radius:16px; border:2px solid #00ff88; box-shadow:0 0 40px rgba(0,255,136,0.25); }
        .close { position:absolute; top:10px; right:20px; font-size:38px; cursor:pointer; color:#aaa; transition:0.3s; }
        .close:hover { color:#ff4444; }
        .delete-btn { background:linear-gradient(90deg,#ff4444,#cc0000); margin-top:15px; }
        .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:25px; flex-wrap:nowrap; }
        .logo-title { display:flex; align-items:center; gap:12px; }
        .app-name { font-size:1.7em; color:#00ff88; white-space:nowrap; }
        .hamburger { font-size:36px; background:none; border:none; color:#00ff88; cursor:pointer; padding:6px 12px; border-radius:50%; transition:all 0.3s; margin-left:auto; }
        .hamburger:hover { background:rgba(0,255,136,0.18); transform:scale(1.15); }
        .side-menu { position:fixed; top:0; right:-320px; width:320px; height:100%; background:rgba(26,30,46,0.98); border-left:2px solid #00ff88; box-shadow:-12px 0 35px rgba(0,255,136,0.25); transition:right 0.4s ease; z-index:2000; padding:25px; color:#e0e0e0; backdrop-filter:blur(8px); overflow-y:auto; }
        .side-menu.open { right:0 !important; }
        .side-menu-header { display:flex; justify-content:space-between; align-items:center; margin-bottom:35px; }
        .side-menu-header h2 { margin:0; color:#00ff88; font-size:1.6em; }
        .side-menu ul { list-style:none; padding:0; margin:0; }
        .side-menu li { padding:18px 0; border-bottom:1px solid #2a344a; cursor:pointer; transition:all 0.3s; font-size:1.1em; display:flex; align-items:center; gap:10px; }
        .side-menu li:hover { color:#00ff88; padding-left:15px; }
        .side-menu .logout-section { position:absolute; bottom:40px; left:25px; right:25px; }
        .overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.75); z-index:1500; display:none; }
        .overlay.show { display:block; }
        .developer-credit { position:fixed; bottom:0; left:0; right:0; background:rgba(26,30,46,0.95); color:#888; text-align:center; padding:12px; font-size:14px; border-top:1px solid #00ff88; z-index:999; backdrop-filter:blur(10px); }
        .developer-credit a { color:#00ff88; text-decoration:none; font-weight:bold; transition:0.3s; }
        .developer-credit a:hover { color:#ffffff; text-shadow:0 0 12px #00ff88; }
                @media (max-width:768px) { 
            .hamburger { font-size:30px; } 
            .side-menu { width:280px; padding:20px; } 
            .app-name { font-size:1.4em; } 
            .day { min-height:65px; padding:4px 2px; }
            .day-number { font-size:14px; }
            .day-amount { font-size:10px; }
            .auth-tabs { flex-direction:column; }
            .button-group { flex-direction:column; }
            .feature-list { grid-template-columns:1fr; }
        }
        @media (max-width:480px) {
            .day { min-height:60px; }
            .calendar-header { font-size:12px; padding:8px; }
            #calendar { gap:6px; }
            .card { padding:15px; }
            .login-logo img { height:60px; }
            .login-logo h1 { font-size:1.5em; }
        }
    </style>
</head>
<body>

    <!-- ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ -->
    <div id="globalLoader" class="loader-overlay">
        <div style="text-align: center;">
            <div class="spinner"></div>
            <div class="loading-text" id="loadingMessage">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        </div>
    </div>

    <div id="progressContainer" class="progress-container">
        <div id="progressBar" class="progress-bar"></div>
    </div>

    <div class="overlay" id="overlay" onclick="closeSideMenu()"></div>

    <div class="side-menu" id="sideMenu">
        <div class="side-menu-header">
            <h2>‡¶Æ‡ßá‡¶®‡ßÅ</h2>
            <span class="close" onclick="closeSideMenu()">√ó</span>
        </div>
        <ul>
            <li onclick="openLastMonthReport()">üìä ‡¶¨‡¶ø‡¶ó‡¶§ ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</li>
            <li onclick="toggleTheme()">üåô ‡¶•‡¶ø‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®</li>
            <li onclick="openExportPage()">üì§ ‡¶è‡¶ï‡ßç‡¶∏‡¶™‡ßã‡¶∞‡ßç‡¶ü ‡¶°‡¶æ‡¶ü‡¶æ</li>
            <li><a href="https://t.me/abdullha2" target="_blank" style="color:inherit; text-decoration:none; display:flex; align-items:center; gap:10px;"><span>üíÅ</span>‡¶π‡ßá‡¶≤‡ßç‡¶™ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶° ‡¶∏‡¶æ‡¶™‡ßã‡¶∞‡ßç‡¶ü</a></li>
        </ul>
        <div class="logout-section">
            <button class="logout-btn" onclick="logout()" style="width:100%;">‡¶≤‡¶ó ‡¶Ü‡¶â‡¶ü</button>
        </div>
    </div>

    <div class="container">
        <div id="loginSection" class="card auth-container">
            <div class="login-logo">
                <img src="https://uploads.onecompiler.io/42weeh2u8/44afppfx3/1000029290.png" alt="Calendar Save Money Logo">
                <h1>Calendar Save Money Account</h1>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="showAuthForm('login')">‡¶≤‡¶ó‡¶á‡¶®</button>
                <button class="auth-tab" onclick="showAuthForm('signup')">‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™</button>
            </div>
            
            <div id="loginForm" class="auth-form active">
                <div class="error" id="loginError"></div>
                <div class="success" id="loginSuccess"></div>
                
                <div class="form-group">
                    <label for="loginEmail">‡¶á‡¶Æ‡ßá‡¶á‡¶≤</label>
                    <input type="email" id="loginEmail" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ">
                </div>
                
                <div class="form-group">
                    <label for="loginPassword">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</label>
                    <input type="password" id="loginPassword" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°">
                </div>
                
                <div class="button-group">
                    <button onclick="login()" id="loginBtn">
                        <span id="loginText">‡¶≤‡¶ó‡¶á‡¶®</span>
                    </button>
                    <button onclick="showAuthForm('signup')" style="background:#2a344a; color:#fff;">‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á?</button>
                </div>
            </div>
            
            <div id="signupForm" class="auth-form">
                <div class="error" id="signupError"></div>
                <div class="success" id="signupSuccess"></div>
                
                <div class="form-group">
                    <label for="signupEmail">‡¶á‡¶Æ‡ßá‡¶á‡¶≤</label>
                    <input type="email" id="signupEmail" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ">
                </div>
                
                <div class="form-group">
                    <label for="signupPassword">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶°</label>
                    <input type="password" id="signupPassword" placeholder="‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° (‡¶®‡ßç‡¶Ø‡ßÇ‡¶®‡¶§‡¶Æ ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞)">
                </div>
                
                <div class="form-group">
                    <label for="confirmPassword">‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡ßÅ‡¶®</label>
                    <input type="password" id="confirmPassword" placeholder="‡¶™‡ßÅ‡¶®‡¶∞‡¶æ‡ßü ‡¶™‡¶æ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®">
                </div>
                
                <div class="button-group">
                    <button onclick="signup()" id="signupBtn">
                        <span id="signupText">‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™</span>
                    </button>
                    <button onclick="showAuthForm('login')" style="background:#2a344a; color:#fff;">‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶Ü‡¶õ‡ßá?</button>
                </div>
            </div>
            
            <div class="advanced-features">
                <h4>üì± ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶´‡¶ø‡¶ö‡¶æ‡¶∞‡¶∏‡¶Æ‡ßÇ‡¶π:</h4>
                <div class="feature-list">
                    <div class="feature-item">
                        <div class="feature-icon">üéØ</div>
                        <strong>‡¶∏‡ßç‡¶Æ‡¶æ‡¶∞‡ßç‡¶ü ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶£</strong>
                        <p>‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∏‡ßá‡¶≠‡¶ø‡¶Ç‡¶∏ ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üìä</div>
                        <strong>‡¶°‡¶ø‡¶ü‡ßá‡¶á‡¶≤‡¶° ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü</strong>
                        <p>‡¶ó‡ßç‡¶∞‡¶æ‡¶´ ‡¶ì ‡¶ö‡¶æ‡¶∞‡ßç‡¶ü‡ßá ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üîí</div>
                        <strong>‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞ ‡¶°‡¶æ‡¶ü‡¶æ</strong>
                        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶ø‡¶§</p>
                    </div>
                    <div class="feature-item">
                        <div class="feature-icon">üìÖ</div>
                        <strong>‡¶°‡ßá‡¶á‡¶≤‡¶ø ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç</strong>
                        <p>‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶Ü‡ßü-‡¶¨‡ßç‡¶Ø‡ßü ‡¶Æ‡¶®‡¶ø‡¶ü‡¶∞</p>
                    </div>
                </div>
            </div>
            
            <div class="loader" id="authLoader" style="display:none; text-align:center; margin:20px 0;">
                <div style="color:#00ff88;">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
            </div>
        </div>

        <div id="appSection" class="hidden">
            <div class="header">
                <div class="logo-title">
                    <img src="https://uploads.onecompiler.io/42weeh2u8/44afppfx3/1000029290.png" alt="Logo" class="logo-img" style="height:50px; width:auto;">
                    <span class="app-name">Calendar Save Money Account</span>
                </div>
                <button class="hamburger" onclick="openSideMenu()">‚ò∞</button>
            </div>
            
            <div class="card">
                <div class="month-nav">
                    <button onclick="prevMonth()">‚Üê</button>
                    <h2 id="monthYear"></h2>
                    <button onclick="nextMonth()">‚Üí</button>
                </div>
                <div id="calendar"></div>
            </div>
            
            <div class="summary card">
                <h3>‡¶è‡¶á ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶Æ‡ßã‡¶ü ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨</h3>
                <p>‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶ï‡¶æ‡¶Æ: <span id="totalIncome">0.00</span> USDT</p>
                <p>‡¶Æ‡ßã‡¶ü ‡¶ñ‡¶∞‡¶ö: <span id="totalExpense">0.00</span> USDT</p>
                <p>‡¶Æ‡ßã‡¶ü ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü: <span id="totalInvest">0.00</span> USDT</p>
                <p class="profit" id="profitLoss">‡¶≤‡¶æ‡¶≠/‡¶≤‡¶∏: 0.00 USDT</p>
            </div>
        </div>
    </div>
        <!-- Day Modal -->
    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">√ó</span>
            <h3 id="modalDate"></h3>
            <div class="error" id="modalError"></div>
            
            <div class="form-group">
                <label for="income">‡¶á‡¶®‡¶ï‡¶æ‡¶Æ (USDT)</label>
                <input type="number" step="0.01" id="income" placeholder="‡¶á‡¶®‡¶ï‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
            </div>
            
            <div class="form-group">
                <label for="incomeSource">‡¶á‡¶®‡¶ï‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶â‡ßé‡¶∏</label>
                <input type="text" id="incomeSource" placeholder="‡¶ï‡ßã‡¶•‡¶æ ‡¶•‡ßá‡¶ï‡ßá? (Binance, Referral...)" list="incomeSources">
            </div>
            
            <div class="form-group">
                <label for="expense">‡¶ñ‡¶∞‡¶ö (USDT)</label>
                <input type="number" step="0.01" id="expense" placeholder="‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
            </div>
            
            <div class="form-group">
                <label for="expenseCategory">‡¶ñ‡¶∞‡¶ö‡ßá‡¶∞ ‡¶ß‡¶∞‡¶£</label>
                <input type="text" id="expenseCategory" placeholder="‡¶ï‡ßã‡¶•‡¶æ‡ßü ‡¶ñ‡¶∞‡¶ö? (Food, Fee...)" list="expenseCategories">
            </div>
            
            <div class="form-group">
                <label for="invest">‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü (USDT)</label>
                <input type="number" step="0.01" id="invest" placeholder="‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£">
            </div>
            
            <div class="form-group">
                <label for="investPlatform">‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡ßç‡¶≤‡ßç‡¶Ø‡¶æ‡¶ü‡¶´‡¶∞‡ßç‡¶Æ</label>
                <input type="text" id="investPlatform" placeholder="‡¶ï‡ßã‡¶•‡¶æ‡ßü ‡¶á‡¶®‡¶≠‡ßá‡¶∏‡ßç‡¶ü? (Staking, Futures...)" list="investPlatforms">
            </div>
            
            <div class="form-group">
                <label for="note">‡¶®‡ßã‡¶ü</label>
                <textarea id="note" rows="3" placeholder="‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡¶ø‡¶∂‡ßá‡¶∑ ‡¶®‡ßã‡¶ü"></textarea>
            </div>
            
            <button onclick="saveDay()">üíæ ‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
            <button class="delete-btn" id="deleteBtn" onclick="deleteDay()" style="display:none;">üóëÔ∏è ‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </div>
    </div>

    <!-- Datalists -->
    <datalist id="incomeSources">
        <option value="Binance">
        <option value="Bybit">
        <option value="OKX">
        <option value="Referral">
        <option value="YouTube">
        <option value="Telegram">
        <option value="Airdrop">
        <option value="Trading">
        <option value="Staking">
        <option value="Freelancing">
    </datalist>
    
    <datalist id="expenseCategories">
        <option value="Food">
        <option value="Rent">
        <option value="Ads">
        <option value="Fee">
        <option value="Withdrawal">
        <option value="Gift">
        <option value="Shopping">
        <option value="Transport">
        <option value="Bills">
    </datalist>
    
    <datalist id="investPlatforms">
        <option value="Staking">
        <option value="Futures">
        <option value="Spot">
        <option value="Node">
        <option value="Launchpad">
        <option value="Liquidity Pool">
        <option value="Savings">
    </datalist>

    <div class="developer-credit">
        <span class="developer-logo">üöÄ</span>
        <strong>Developed by</strong> 
        <a href="https://t.me/abdullha2" target="_blank">Abdullah Khan</a>
        <span class="version">v1.3.0</span>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, signInWithEmailAndPassword, createUserWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDocs, deleteDoc, query, where, Timestamp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyCOfdNrWquXTJE1t04P3BHqRa5iCI8jHK0",
            authDomain: "calendar-888d2.firebaseapp.com",
            projectId: "calendar-888d2",
            storageBucket: "calendar-888d2.firebasestorage.app",
            messagingSenderId: "778995585586",
            appId: "1:778995585586:web:885962728d935d7c1da22b",
            measurementId: "G-JHKNCR2WTS"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        let currentUser = null;
        let currentMonth = new Date();
        let selectedDate = null;
        let monthlyData = {};
        let isLightTheme = false;

        // ========== ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ==========
        function showGlobalLoader(message = '‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...') {
            const loader = document.getElementById('globalLoader');
            const messageEl = document.getElementById('loadingMessage');
            if (loader && messageEl) {
                messageEl.textContent = message;
                loader.style.display = 'flex';
            }
        }

        function hideGlobalLoader() {
            const loader = document.getElementById('globalLoader');
            if (loader) {
                loader.style.display = 'none';
            }
        }

        function showButtonLoader(buttonId, loadingText = '‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç...') {
            const button = document.getElementById(buttonId);
            if (button) {
                const textSpan = button.querySelector('span');
                if (textSpan) {
                    button.setAttribute('data-original-text', textSpan.textContent);
                    textSpan.innerHTML = `<div class="small-loader"></div> ${loadingText}`;
                }
                button.disabled = true;
                button.style.opacity = '0.7';
            }
        }

        function hideButtonLoader(buttonId) {
            const button = document.getElementById(buttonId);
            if (button) {
                const originalText = button.getAttribute('data-original-text') || button.textContent;
                const textSpan = button.querySelector('span');
                if (textSpan) {
                    textSpan.textContent = originalText;
                }
                button.disabled = false;
                button.style.opacity = '1';
            }
        }

        function showProgressBar() {
            const container = document.getElementById('progressContainer');
            if (container) {
                container.style.display = 'block';
            }
        }

        function updateProgressBar(percent) {
            const bar = document.getElementById('progressBar');
            if (bar) {
                bar.style.width = percent + '%';
            }
        }

        function hideProgressBar() {
            const container = document.getElementById('progressContainer');
            const bar = document.getElementById('progressBar');
            if (container && bar) {
                bar.style.width = '100%';
                setTimeout(() => {
                    container.style.display = 'none';
                    bar.style.width = '0%';
                }, 300);
            }
        }

        const loadingMessages = [
            "‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...",
            "‡¶ï‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...",
            "‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶•‡ßç‡¶Ø ‡¶®‡¶ø‡ßü‡ßá ‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...",
            "‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®...",
            "‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç...",
            "‡¶∏‡¶¨ ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶†‡¶ø‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá..."
        ];

        function getRandomLoadingMessage() {
            return loadingMessages[Math.floor(Math.random() * loadingMessages.length)];
        }
        // ========== ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ‡¶∂‡ßá‡¶∑ ==========

        // ‡¶≤‡¶ó‡¶á‡¶®/‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™ ‡¶ü‡ßç‡¶Ø‡¶æ‡¶¨ ‡¶∏‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶Æ
        window.showAuthForm = (formType) => {
            document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(form => form.classList.remove('active'));
            
            if (formType === 'login') {
                document.querySelector('.auth-tab:nth-child(1)').classList.add('active');
                document.getElementById('loginForm').classList.add('active');
                setTimeout(() => document.getElementById('loginEmail').focus(), 100);
            } else {
                document.querySelector('.auth-tab:nth-child(2)').classList.add('active');
                document.getElementById('signupForm').classList.add('active');
                setTimeout(() => document.getElementById('signupEmail').focus(), 100);
            }
        };

        // ‡¶•‡¶ø‡¶Æ ‡¶ü‡¶ó‡¶≤ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
        window.toggleTheme = () => {
            isLightTheme = !isLightTheme;
            if (isLightTheme) {
                document.body.style.background = "linear-gradient(135deg,#f5f5f5,#e8e8e8)";
                document.body.style.color = "#333";
                alert("‡¶•‡¶ø‡¶Æ ‡¶≤‡¶æ‡¶á‡¶ü ‡¶Æ‡ßã‡¶°‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá");
            } else {
                document.body.style.background = "linear-gradient(135deg,#0a0f1a,#121a2e)";
                document.body.style.color = "#e0e0e0";
                alert("‡¶•‡¶ø‡¶Æ ‡¶°‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡ßã‡¶°‡ßá ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá");
            }
            closeSideMenu();
            localStorage.setItem('theme', isLightTheme ? 'light' : 'dark');
        };

        onAuthStateChanged(auth, (user) => {
            if (user) {
                showGlobalLoader('‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
                showProgressBar();
                updateProgressBar(20);
                
                currentUser = user;
                document.getElementById('loginSection').classList.add('hidden');
                document.getElementById('appSection').classList.remove('hidden');
                
                updateProgressBar(50);
                
                setTimeout(() => {
                    updateProgressBar(70);
                    loadAndRender();
                }, 300);
                
            } else {
                currentUser = null;
                document.getElementById('loginSection').classList.remove('hidden');
                document.getElementById('appSection').classList.add('hidden');
                hideGlobalLoader();
                hideProgressBar();
            }
        });

        function showLoader(id) { 
            document.getElementById(id).style.display = 'block'; 
        }
        
        function hideLoader(id) { 
            document.getElementById(id).style.display = 'none'; 
        }

        function showMessage(type, id, message) {
            const el = document.getElementById(id);
            el.textContent = message;
            el.style.color = type === 'error' ? '#ff4444' : '#00ff88';
            el.style.display = 'block';
            setTimeout(() => el.style.display = 'none', 3000);
        }

        window.login = async () => {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value.trim();
            
            if (!email || !password) {
                return showMessage('error', 'loginError', '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶¶‡¶ø‡¶®');
            }
            
            showButtonLoader('loginBtn', '‡¶≤‡¶ó‡¶á‡¶® ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            showProgressBar();
            updateProgressBar(30);
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                updateProgressBar(70);
                showMessage('success', 'loginSuccess', '‡¶≤‡¶ó‡¶á‡¶® ‡¶∏‡¶´‡¶≤!');
            } catch (error) {
                let errorMsg = '‡¶≤‡¶ó‡¶á‡¶® ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•!';
                if (error.code === 'auth/invalid-credential') errorMsg = '‡¶≠‡ßÅ‡¶≤ ‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶¨‡¶æ ‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶°';
                else if (error.code === 'auth/user-not-found') errorMsg = '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡ßá‡¶á';
                showMessage('error', 'loginError', errorMsg);
            } finally {
                updateProgressBar(100);
                hideButtonLoader('loginBtn');
                setTimeout(() => hideProgressBar(), 200);
            }
        };

        window.signup = async () => {
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value.trim();
            const confirmPassword = document.getElementById('confirmPassword').value.trim();
            
            if (!email || !password || !confirmPassword) {
                return showMessage('error', 'signupError', '‡¶∏‡¶ï‡¶≤ ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®');
            }
            if (password.length < 6) {
                return showMessage('error', 'signupError', '‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ß¨ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá');
            }
            if (password !== confirmPassword) {
                return showMessage('error', 'signupError', '‡¶™‡¶æ‡¶∏‡¶ì‡ßü‡¶æ‡¶∞‡ßç‡¶° ‡¶Æ‡¶ø‡¶≤‡¶õ‡ßá ‡¶®‡¶æ');
            }
            
            showButtonLoader('signupBtn', '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            showProgressBar();
            updateProgressBar(20);
            
            try {
                await createUserWithEmailAndPassword(auth, email, password);
                updateProgressBar(60);
                showMessage('success', 'signupSuccess', '‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶§‡ßà‡¶∞‡¶ø ‡¶∏‡¶´‡¶≤!');
                
                updateProgressBar(80);
                setTimeout(() => {
                    login();
                }, 500);
                
            } catch (error) {
                let errorMsg = '‡¶∏‡¶æ‡¶á‡¶®‡¶Ü‡¶™ ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•!';
                if (error.code === 'auth/email-already-in-use') errorMsg = '‡¶á‡¶Æ‡ßá‡¶á‡¶≤ ‡¶á‡¶§‡¶ø‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞‰∏≠';
                showMessage('error', 'signupError', errorMsg);
            } finally {
                updateProgressBar(100);
                hideButtonLoader('signupBtn');
                setTimeout(() => hideProgressBar(), 200);
            }
        };

        window.logout = async () => {
            showGlobalLoader('‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            showProgressBar();
            updateProgressBar(30);
            
            try {
                updateProgressBar(60);
                await signOut(auth);
                updateProgressBar(80);
                closeSideMenu();
                showMessage('success', 'loginSuccess', '‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü ‡¶∏‡¶´‡¶≤!');
            } catch (error) {
                console.error('Logout error:', error);
            } finally {
                updateProgressBar(100);
                setTimeout(() => {
                    hideGlobalLoader();
                    hideProgressBar();
                }, 200);
            }
        };

        const loadAndRender = async () => {
            if (!currentUser) return;
            
            showGlobalLoader(getRandomLoadingMessage());
            showProgressBar();
            updateProgressBar(10);
            
            try {
                const year = currentMonth.getFullYear();
                const month = currentMonth.getMonth();
                document.getElementById('monthYear').textContent = currentMonth.toLocaleDateString('bn-BD', { month: 'long', year: 'numeric' });
                
                updateProgressBar(30);
                const start = new Date(year, month, 1);
                const end = new Date(year, month + 1, 0, 23, 59, 59);
                monthlyData = {};
                
                updateProgressBar(50);
                const q = query(collection(db, 'users', currentUser.uid, 'days'),
                    where('timestamp', '>=', Timestamp.fromDate(start)),
                    where('timestamp', '<=', Timestamp.fromDate(end)));
                
                updateProgressBar(70);
                const snapshot = await getDocs(q);
                snapshot.forEach(doc => monthlyData[doc.id] = doc.data());
                
                updateProgressBar(80);
                renderCalendar();
                updateProgressBar(90);
                updateSummary();
                
            } catch (error) {
                console.error('Error loading data:', error);
                showMessage('error', 'modalError', '‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
            } finally {
                updateProgressBar(100);
                setTimeout(() => {
                    hideGlobalLoader();
                    hideProgressBar();
                }, 200);
            }
        };
        const renderCalendar = () => {
            const year = currentMonth.getFullYear();
            const month = currentMonth.getMonth();
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date().toISOString().slice(0, 10);
            const calendar = document.getElementById('calendar');
            calendar.innerHTML = '';
            
            ['‡¶∞‡¶¨‡¶ø','‡¶∏‡ßã‡¶Æ','‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤','‡¶¨‡ßÅ‡¶ß','‡¶¨‡ßÉ‡¶π‡¶É','‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞','‡¶∂‡¶®‡¶ø'].forEach(d => {
                const h = document.createElement('div');
                h.className = 'calendar-header';
                h.textContent = d;
                calendar.appendChild(h);
            });
            
            for (let i = 0; i < firstDay; i++) calendar.appendChild(document.createElement('div'));
            
            let ti=0, te=0, tiv=0;
            for (let d = 1; d <= daysInMonth; d++) {
                const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
                const data = monthlyData[dateStr] || {};
                const el = document.createElement('div');
                el.className = 'day';
                const inc = data.income || 0;
                const exp = data.expense || 0;
                const inv = data.invest || 0;
                ti += inc; te += exp; tiv += inv;
                
                let html = `<div class="day-number">${d}</div>`;
                if (inc > 0) html += `<div class="day-amount" style="color:#00ff88;">+${inc.toFixed(2)}</div>`;
                if (exp > 0) html += `<div class="day-amount" style="color:#ff4444;">-${exp.toFixed(2)}</div>`;
                if (inv > 0) html += `<div class="day-amount" style="color:#ff9500;">${inv.toFixed(2)}</div>`;
                
                el.innerHTML = html;
                if (dateStr === today) el.classList.add('today');
                if (Object.keys(data).length > 0) el.classList.add('has-data');
                el.onclick = () => openModal(dateStr);
                calendar.appendChild(el);
            }
            
            document.getElementById('totalIncome').textContent = ti.toFixed(2);
            document.getElementById('totalExpense').textContent = te.toFixed(2);
            document.getElementById('totalInvest').textContent = tiv.toFixed(2);
            const tp = ti - te - tiv;
            const pEl = document.getElementById('profitLoss');
            pEl.textContent = `‡¶≤‡¶æ‡¶≠/‡¶≤‡¶∏: ${tp.toFixed(2)} USDT`;
            pEl.className = tp >= 0 ? 'profit' : 'profit loss';
        };

        const updateSummary = () => {
            let ti=0, te=0, tiv=0;
            Object.values(monthlyData).forEach(d => {
                ti += d.income || 0;
                te += d.expense || 0;
                tiv += d.invest || 0;
            });
            document.getElementById('totalIncome').textContent = ti.toFixed(2);
            document.getElementById('totalExpense').textContent = te.toFixed(2);
            document.getElementById('totalInvest').textContent = tiv.toFixed(2);
            const tp = ti - te - tiv;
            const pEl = document.getElementById('profitLoss');
            pEl.textContent = `‡¶≤‡¶æ‡¶≠/‡¶≤‡¶∏: ${tp.toFixed(2)} USDT`;
            pEl.className = tp >= 0 ? 'profit' : 'profit loss';
        };

        window.openModal = (date) => {
            selectedDate = date;
            const dt = new Date(date);
            document.getElementById('modalDate').textContent = dt.toLocaleDateString('bn-BD', {weekday:'long', year:'numeric', month:'long', day:'numeric'});
            const data = monthlyData[date] || {};
            document.getElementById('income').value = data.income || '';
            document.getElementById('incomeSource').value = data.incomeSource || '';
            document.getElementById('expense').value = data.expense || '';
            document.getElementById('expenseCategory').value = data.expenseCategory || '';
            document.getElementById('invest').value = data.invest || '';
            document.getElementById('investPlatform').value = data.investPlatform || '';
            document.getElementById('note').value = data.note || '';
            document.getElementById('deleteBtn').style.display = Object.keys(data).length > 0 ? 'block' : 'none';
            document.getElementById('modal').style.display = 'block';
        };

        window.saveDay = async () => {
            if (!currentUser) return;
            
            const income = parseFloat(document.getElementById('income').value) || 0;
            const expense = parseFloat(document.getElementById('expense').value) || 0;
            const invest = parseFloat(document.getElementById('invest').value) || 0;
            
            if (income === 0 && expense === 0 && invest === 0) {
                return showMessage('error', 'modalError', '‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶´‡¶ø‡¶≤‡ßç‡¶° ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶®');
            }
            
            showGlobalLoader('‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            showProgressBar();
            updateProgressBar(30);
            
            const data = {
                income,
                incomeSource: document.getElementById('incomeSource').value.trim(),
                expense,
                expenseCategory: document.getElementById('expenseCategory').value.trim(),
                invest,
                investPlatform: document.getElementById('investPlatform').value.trim(),
                note: document.getElementById('note').value.trim(),
                timestamp: Timestamp.fromDate(new Date(selectedDate))
            };
            
            try {
                updateProgressBar(60);
                await setDoc(doc(db, 'users', currentUser.uid, 'days', selectedDate), data);
                updateProgressBar(80);
                monthlyData[selectedDate] = data;
                closeModal();
                renderCalendar();
                updateSummary();
                showMessage('success', 'modalSuccess', '‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡ßá‡¶≠ ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
            } catch (error) {
                console.error('Error saving data:', error);
                showMessage('error', 'modalError', '‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
            } finally {
                updateProgressBar(100);
                setTimeout(() => {
                    hideGlobalLoader();
                    hideProgressBar();
                }, 250);
            }
        };

        window.deleteDay = async () => {
            if (!currentUser || !confirm('‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶Ø‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶è‡¶á ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶°‡ßá‡¶ü‡¶æ ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶§‡ßá ‡¶ö‡¶æ‡¶®?')) return;
            
            showGlobalLoader('‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            showProgressBar();
            updateProgressBar(30);
            
            try {
                updateProgressBar(60);
                await deleteDoc(doc(db, 'users', currentUser.uid, 'days', selectedDate));
                updateProgressBar(80);
                delete monthlyData[selectedDate];
                closeModal();
                renderCalendar();
                updateSummary();
                showMessage('success', 'modalSuccess', '‡¶°‡ßá‡¶ü‡¶æ ‡¶∏‡¶´‡¶≤‡¶≠‡¶æ‡¶¨‡ßá ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶π‡ßü‡ßá‡¶õ‡ßá!');
            } catch (error) {
                console.error('Error deleting data:', error);
                showMessage('error', 'modalError', '‡¶°‡ßá‡¶ü‡¶æ ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
            } finally {
                updateProgressBar(100);
                setTimeout(() => {
                    hideGlobalLoader();
                    hideProgressBar();
                }, 300);
            }
        };

        window.closeModal = () => {
            document.getElementById('modal').style.display = 'none';
            document.getElementById('modalError').style.display = 'none';
        };

        window.prevMonth = () => { 
            showGlobalLoader('‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶Æ‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            currentMonth.setMonth(currentMonth.getMonth() - 1); 
            loadAndRender(); 
        };
        
        window.nextMonth = () => { 
            showGlobalLoader('‡¶™‡¶∞‡¶¨‡¶∞‡ßç‡¶§‡ßÄ ‡¶Æ‡¶æ‡¶∏ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...');
            currentMonth.setMonth(currentMonth.getMonth() + 1); 
            loadAndRender(); 
        };

        function openSideMenu() {
            const menu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');
            if (menu && overlay) {
                menu.classList.add('open');
                overlay.classList.add('show');
            }
        }

        function closeSideMenu() {
            const menu = document.getElementById('sideMenu');
            const overlay = document.getElementById('overlay');
            if (menu && overlay) {
                menu.classList.remove('open');
                overlay.classList.remove('show');
            }
        }

        function openLastMonthReport() {
            closeSideMenu();
            window.open('last-month-report.html', '_blank');
        }

        function openExportPage() {
            closeSideMenu();
            window.open('export-data.html', '_blank');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const hamburger = document.querySelector('.hamburger');
            if (hamburger) {
                hamburger.addEventListener('click', openSideMenu);
            }

            document.getElementById('overlay').addEventListener('click', closeSideMenu);

            document.getElementById('monthYear').textContent = currentMonth.toLocaleDateString('bn-BD', { month: 'long', year: 'numeric' });
            
            document.getElementById('loginEmail').focus();
            
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'light') {
                isLightTheme = true;
                document.body.style.background = "linear-gradient(135deg,#f5f5f5,#e8e8e8)";
                document.body.style.color = "#333";
            }
        });
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeSideMenu();
                closeModal();
            }
        });
    </script>
</body>
</html>
